

<div class="mainDiv" style="text-align: center;">


    <p style="font-weight: bold;">Selecciona la opcion para buscar usuarios</p>

    <mat-form-field appearance="fill" style="margin-right: 10px;">
      <mat-label>Filtro de regionales</mat-label>
      <mat-select [formControl]="regionales">
        <mat-option *ngFor="let tipo of regionalesFiltro; let i = index" [value]="i">
          {{tipo}}
        </mat-option>
      </mat-select>
  </mat-form-field>


    <mat-form-field appearance="fill">
        <mat-label>Tipos de busquedas</mat-label>
        <mat-select [formControl]="seleccionTipo"
        (selectionChange)="busquedaTipo($event.value)">
          <mat-option *ngFor="let tipo of tiposBusqudas; let i = index" [value]="i">
            {{tipo}}
          </mat-option>
        </mat-select>
    </mat-form-field>


    <div [ngSwitch]="seleccionTipo.value">

      <div *ngSwitchCase="2">

        <mat-form-field appearance="fill">
          <mat-label>Elige el dia</mat-label>
          <input matInput [matDatepicker]="picker"
          (dateChange)="seleccionDia($event.value)">
          <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>


      </div>

      <div *ngSwitchCase="3">

      <mat-form-field appearance="fill">
        <mat-label>Numero de empleado</mat-label>
        <input matInput (change)="numeroDeUsuario($event.target.value)"
        type="number">
      </mat-form-field>

      </div>

      <div *ngSwitchCase="4">

        <mat-form-field appearance="fill">
          <mat-label>Plantas</mat-label>
          <mat-select 
          (selectionChange)="buscarPorPlanta($event.value)">
            <mat-option *ngFor="let planta of plantas;" [value]="planta">
              {{planta}}
            </mat-option>
          </mat-select>
      </mat-form-field>
  
      </div>

      <div *ngSwitchCase="5">

        <mat-form-field appearance="fill">
          <mat-label>Departamentos</mat-label>
          <mat-select 
          (selectionChange)="buscarPorDepartamento($event.value)">
            <mat-option *ngFor="let departamento of departamentos;" [value]="departamento">
              {{departamento}}
            </mat-option>
          </mat-select>
      </mat-form-field>
  
      </div>


      <div *ngSwitchCase="6">

        <mat-form-field appearance="fill">
          <mat-label>Roles</mat-label>
          <mat-select 
          (selectionChange)="buscarPorRole($event.value)">
            <mat-option *ngFor="let role of roles;" [value]="role">
              {{role}}
            </mat-option>
          </mat-select>
      </mat-form-field>
  
      </div>

    </div>

    <button (click)="descargarExcel()"
    mat-raised-button color="primary"
    [disabled]="usuarios.data.length == 0 "
    style="margin-bottom: 10px;">
      Descargar excel
      <mat-icon>description</mat-icon>
    </button>


    <mat-card>
      


      <mat-checkbox *ngFor="let propiedad  of usuarioPropiedades; "
      [(ngModel)]="propiedad.check"
      style="margin-left: 5px; margin-right: 5px;">
      {{propiedad.nombre}}
      </mat-checkbox>



      





    </mat-card>
    
    

    <table mat-table [dataSource]="usuarios" style=" margin-top: 25px; width: 100%;" >

        <tr mat-header-row *matHeaderRowDef="columnas"  ></tr>
        <tr mat-row *matRowDef="let row; columns: columnas;" ></tr>

        <!-- Position Column -->

        <ng-container matColumnDef="foto">
            <th mat-header-cell *matHeaderCellDef width="15%"> Foto </th>
            <td mat-cell *matCellDef="let element" width="15%"> 

                <img [src]="element.image" 
                style="border-radius: 150px;" width="80">

            </td>
          </ng-container>

          <ng-container matColumnDef="nombre">
            <th mat-header-cell *matHeaderCellDef> Nombre </th>
            <td mat-cell *matCellDef="let element"> 
  
             {{ element.fullName}}
          
          </td>
          </ng-container>

          <ng-container matColumnDef="correo">
            <th mat-header-cell *matHeaderCellDef> Correo </th>
            <td mat-cell *matCellDef="let element"> 
  
             {{ element.email}}
          
          </td>
          </ng-container>

        <ng-container matColumnDef="numero">
          <th mat-header-cell *matHeaderCellDef> Numero de empleado </th>
          <td mat-cell *matCellDef="let element"> 

            {{ element.employeeNumber}}
        
        </td>
        </ng-container>
    
        <!-- Name Column -->
        <ng-container matColumnDef="planta">
          <th mat-header-cell *matHeaderCellDef> Planta </th>
          <td mat-cell *matCellDef="let element"> {{element.idPlant}} </td>
        </ng-container>
    
        <!-- Weight Column -->
        <ng-container matColumnDef="deparamento">
          <th mat-header-cell *matHeaderCellDef> Departamento </th>
          <td mat-cell *matCellDef="let element"> {{element.idDepartment}} </td>
        </ng-container>

       
    
        <!-- Symbol Column -->
        <ng-container matColumnDef="autorizado">
          <th mat-header-cell *matHeaderCellDef> Autorizado </th>
          <td mat-cell *matCellDef="let element;"> 
              
            <mat-checkbox class="example-margin" [checked]="element.authorized"
            style="font-size: large;"
            (change)="actualizarAutorizado(element.id,$event.checked)"></mat-checkbox>

        </td>
        </ng-container>

        <ng-container matColumnDef="regional">
          <th mat-header-cell *matHeaderCellDef> Regional </th>
          <td mat-cell *matCellDef="let element; "> 
              
            <mat-checkbox class="example-margin" [checked]="element.regional"
            style="font-size: large;"
            (change)="actualizarRegional(element.id,$event.checked)"></mat-checkbox>

        </td>
        </ng-container>

    
        
      </table>

   
    
      <mat-paginator [pageSizeOptions]="[10,20]" showFirstLastButtons></mat-paginator>

</div>
